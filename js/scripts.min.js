function loadXMLDoc(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4==c.readyState&&200==c.status&&'function'==typeof b&&b(JSON.parse(c.responseText))},c.open('GET',a,!0),c.send()}function objectToArray(a){for(var b=[],c=Object.keys(a).length,d=0;c>d;d++)b.push(a[d]);return b}function newBoard(a,b){var c=b*(b/2),d=100/b;tiles_flipped=0;var e='';a.memory_tile_shuffle();for(var f=0;c>f;f++)new_memory_array.push(a[f]),new_memory_array.push(a[f]);new_memory_array.memory_tile_shuffle();for(var f=0;f<new_memory_array.length;f++)e+='<div class="tile" id="tile_'+f+'" style="width: '+d+'%; height: '+d+'%" onclick="memoryFlipTile(this,\''+new_memory_array[f]+'\')"><div class="flipper"><div class="front"></div><div class="back" style="background: url(px/'+new_memory_array[f]+'.jpg)"></div></div></div>';document.getElementById('memoryBoard').innerHTML=e}function memoryFlipTile(a,b){if(memory_values.length<2&&!a.hasAttribute('data-flipped')){game_started===!1&&(timer=setInterval(countTime,1e3),game_started=!0),a.setAttribute('data-flipped',!0);var c=a.querySelector('.flipper');if(flipperShow(c),0==memory_values.length)memory_values.push(b),memory_tile_ids.push(a.id);else if(1==memory_values.length)if(memory_values.push(b),memory_tile_ids.push(a.id),memory_values[0]==memory_values[1]){var d=document.getElementById(memory_tile_ids[0]),e=document.getElementById(memory_tile_ids[1]);fadeTile(d),fadeTile(e),tiles_flipped+=2,memory_values=[],memory_tile_ids=[],tiles_flipped==new_memory_array.length&&finishGame(current_object,current_level.tiles)}else setTimeout(flip2Back,1e3)}}function flip2Back(){var a=document.getElementById(memory_tile_ids[0]),b=document.getElementById(memory_tile_ids[1]);a.removeAttribute('data-flipped'),b.removeAttribute('data-flipped');var c=a.querySelector('.flipper'),d=b.querySelector('.flipper');flipperHide(c),flipperHide(d),memory_values=[],memory_tile_ids=[]}function gameStatus(){game_started===!1&&(timer=setInterval(countTime,1e3),game_started=!0)}function countTime(){current_time++;var a='',b=Math.floor(current_time/60),c=current_time%60;return a=0>b?10>c?'00:0'+c:'00:'+c:10>c?10>b?'0'+b+':0'+c:b+':0'+c:10>b?'0'+b+':'+c:b+':'+c,document.getElementById('timer').innerHTML=a,a}function makeLevelRadioButtons(a){for(var b='',c=Object.keys(a).length,d=0;c>d;d++){if(1===d)var e='checked="checked"';else var e='';b+='<label><input type="radio" name="level" value="'+a[d].tiles+'" '+e+'> '+a[d].name+'</label>'}document.getElementById('levels').innerHTML=b}function hideElement(a){document.getElementById(a).className='hide'}function flipperShow(a){a.className='flipper animate'}function flipperHide(a){a.className='flipper'}function fadeTile(a){a.className='tile fadeout'}function removeClasses(a){console.log(a),document.getElementById(a).className=''}function finishGame(a,b){alert('Congratz! You diddit :)'),document.getElementById('memoryBoard').innerHTML='',new_memory_array=[],memory_values=[],game_started=!1,clearInterval(timer),hideElement('boardContainer'),removeClasses('endGameContainer'),(current_level.highscore=isTimeOnHighscore(current_level.highscore,current_time))?(document.getElementById('isTimeOnHighScore').innerHTML='You did it in '+current_time+' seconds. That\'s good enough for the highscore board!',removeClasses('highScoreContainer')):(removeClasses('playAgain'),document.getElementById('isTimeOnHighScore').innerHTML='Sorry kitten, but your time of '+current_time+' seconds is waaaaaay to slow...'),current_time=0}function getLevel(a,b){for(var c,d,e=Object.keys(a.levels).length,f=!1,g=0;e>g;g++)a.levels[g].tiles===Number(b)&&(c=a.levels[g].name,d=a.levels[g].tiles,highscore=a.highscore[d]?a.highscore[d]:[],f=a.levels[Number(g+1)]?a.levels[g+1].tiles:!1);return obj={name:c,tiles:d,highscore:highscore,nextlevel:f},obj}function getHighscore(a,b,c,d){c='undefined'!=typeof c?c:4,d='undefined'!=typeof d?d:3;var e=a.highscore[c]?a.highscore[c]:[];e=e.sort(compare);for(var f=Object.keys(e).length<d?Object.keys(e).length:d,g='',h=0;f>h;h++)g+='<tr><td>'+e[h].name+'</td><td>'+e[h].time+'</td></tr>';document.getElementById(b).innerHTML=g;for(var i=document.getElementsByClassName('levelName'),h=0;h<i.length;h++)i[h].innerHTML=current_level.name}function compare(a,b){return a.time<b.time?-1:a.time>b.time?1:0}function isTimeOnHighscore(a,b){var c=a?a:[],d={name:!1,time:b};c.push(d),c=c.sort(compare).slice(0,10);for(var e=!1,f=Object.keys(c).length,g=0;f>g;g++)if(c[g].time!==d.time||d.name||(e=!0),e)return c;return e}function saveToFile(a,b){for(var c=document.getElementById('alias').value,d=Object.keys(a).length,e=0;d>e;e++)a[e].name||(a[e].name=c);b.highscore[current_level.tiles]=a;var f=new XMLHttpRequest;f.open('POST','saveobject.php',!0),f.setRequestHeader('Content-type','application/x-www-form-urlencoded'),object_json_string=JSON.stringify(b),f.send('object='+object_json_string),hideElement('endGameHighscoreForm'),getHighscore(b,'highScore10',current_level.tiles,10),removeClasses('endGameHighscore')}var new_memory_array=[],memory_values=[],memory_tile_ids=[],tiles_flipped=0,game_started=!1,current_time=0,timer,current_level,url='/game.json',current_object;loadXMLDoc(url,function(a){TweenMax.to('#logga',1,{scaleX:1.1,scaleY:1.1,repeat:-1,yoyo:!0}),TweenMax.to('#nextLevel',1,{scaleX:1.1,scaleY:1.1,repeat:-1,yoyo:!0}),removeClasses('formContainer'),current_object=a,makeLevelRadioButtons(a.levels),current_level=getLevel(current_object,4);for(var b=objectToArray(current_object.tiles),c=document.getElementsByName('level'),d=null,e=0;e<c.length;e++)c[e].onclick=function(){d?d.value:null,this!==d&&(d=this),current_level=getLevel(current_object,this.value),getHighscore(current_object,'highScore3',this.value),TweenMax.to('#startGame',2,{rotation:720,startAt:{rotation:0}})};document.getElementById('startGame').addEventListener('click',function(){for(var a=document.getElementsByName('level'),c=0;c<a.length;c++)a[c].checked&&(level=a[c].value);newBoard(b,level),hideElement('formContainer'),removeClasses('boardContainer')}),document.getElementById('nextLevel').addEventListener('click',function(){newBoard(b,current_level.nextlevel),current_level=getLevel(current_object,current_level.nextlevel),hideElement('endGameContainer'),removeClasses('boardContainer')}),document.getElementById('sendAlias').addEventListener('click',function(){saveToFile(current_level.highscore,current_object)}),getHighscore(current_object,'highScore3')}),Array.prototype.memory_tile_shuffle=function(){for(var a,b,c=this.length;--c>0;)a=Math.floor(Math.random()*(c+1)),b=this[a],this[a]=this[c],this[c]=b},document.getElementById('mainMenu').addEventListener('click',function(){removeClasses('formContainer'),hideElement('endGameContainer')});